import{r as p,j as l,T as C,G as D,B as v,a as M,b as k,C as X,c as R,d as Y,e as Z,l as _,R as ee,f as te}from"./vendor.f2d3a00e.js";const ne=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))c(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const f of a.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&c(f)}).observe(document,{childList:!0,subtree:!0});function s(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerpolicy&&(a.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?a.credentials="include":i.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function c(i){if(i.ep)return;i.ep=!0;const a=s(i);fetch(i.href,a)}};ne();const re=(r,n)=>{const s=[];for(let c=0;c<n;c++)s[c]=new Array(r).fill("\u26AA");return s},ie=(r,n,s,c,i)=>{const[a,f]=p.exports.useState(re(s,c)),[h,w]=p.exports.useState(),[b,F]=p.exports.useState(!1),[g,y]=p.exports.useState(n.firstPlayerToMove);p.exports.useEffect(()=>{r.on("recieve move",e=>{const t=A(e.counter,e.column);f(t.newGameboard),!S(e.column,t.rowAdded,e.counter,t.newGameboard)&&G(e.opposingPlayerId)}),h&&r.disconnect()},[r,h]);const G=e=>y(n.players.filter(t=>t.id===e)[0]),$=e=>n.players.filter(t=>t.counter===e)[0],j=()=>n.players.filter(e=>e.id!==r.id)[0].id,B=()=>!h&&r.id===g.id,E=e=>{if(!B())return;const t=g.counter,d=A(t,e);f(d.newGameboard);const u=j(),o={opposingPlayerId:u,counter:t,column:e};r.emit("send move",o),!S(e,d.rowAdded,t,d.newGameboard)&&G(u)},S=(e,t,d,u)=>t&&z(u,d,t,e)?(w($(d)),!0):O(u)?(F(!0),!0):!1,A=(e,t)=>{if(I(a,t))return{rowAdded:void 0,newGameboard:a};const d=[...a];let u;for(let o=c-1;o>=0;o--)if(d[o][t]==="\u26AA"){d[o][t]=e,u=o;break}return{rowAdded:u,newGameboard:d}},O=e=>{for(let t=0;t<s;t++)if(!I(e,t))return!1;return!0},I=(e,t)=>e[0][t]!=="\u26AA",z=(e,t,d,u)=>{let o=0,m;for(let x=0;x<=s-1;x++)if(o=e[d][x]===t?o+1:0,o===i)return!0;o=0;for(let x=c-1;x>=0;x--)if(o=e[x][u]===t?o+1:0,o===i)return!0;const{descMinRow:H,descMaxRow:W}=P(d,u,c,s),{descMinCol:q,descMaxCol:K}=T(d,u,c,s);o=0,m=q;for(let x=H;x<=W;x++){if(o=e[x][m]===t?o+1:0,o===i)return!0;if(m===K)break;m++}const{ascMinRow:L,ascMaxRow:J}=U(d,u,c,s),{ascMinCol:Q,ascMaxCol:V}=N(d,u,c,s);o=0,m=Q;for(let x=J;x>=L;x--){if(o=e[x][m]===t?o+1:0,o===i)return!0;if(m===V)break;m++}return!1},P=(e,t,d,u)=>{const o=Math.max(0,e-t),m=Math.min(d-1,u-t+e);return{descMinRow:o,descMaxRow:m}},T=(e,t,d,u)=>{const o=Math.max(0,t-e),m=Math.min(u-1,d-1-e+t);return{descMinCol:o,descMaxCol:m}},U=(e,t,d,u)=>{const o=Math.min(d-1,e+t);return{ascMinRow:Math.max(0,e-(u-1-t)),ascMaxRow:o}},N=(e,t,d,u)=>{const o=Math.max(0,t-(d-1-e)),m=Math.min(u-1,u-1-e+t);return{ascMinCol:o,ascMaxCol:m}};return{makeMove:E,gameboard:a,currentPlayer:g,winningPlayer:h,draw:b,GameInformationText:()=>{let e;return h?e=`${h.username}(${h.counter}) has won!`:b?e="Draw!":e=`${g.username}'s (${g.counter}) turn!`,l(C,{textAlign:"center",variant:"h5",children:e})}}},oe=({gridItem:r,size:n,column:s,row:c,makeMove:i})=>{const a=()=>i(s);return l(D,{item:!0,xs:n,sx:{zIndex:2,display:"flex",justifyContent:"center",alignItems:"center"},children:l(v,{"aria-label":`${c.toString()}:${s.toString()}`,onClick:a,children:l(C,{fontSize:"8vmin",sx:{textShadow:"0px 4px 4px #1F1F1F",transition:"margin 200ms"},children:r})})})},ae=({gameboard:r,makeMove:n})=>{const s=()=>r.map((c,i)=>c.map((a,f)=>l(oe,{gridItem:a,size:1,row:i,column:f,makeMove:n},`${i}${f}`)));return M(k,{sx:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},children:[l(D,{container:!0,columns:r[0].length,sx:{zIndex:1,background:"radial-gradient(circle, rgba(42,42,242,1) 83%, rgba(42,42,242,1) 98%, rgba(0,168,255,1) 100%, rgba(2,0,36,1) 100%, rgba(2,0,36,1) 100%, rgba(0,212,255,1) 100%)",width:"95%",boxShadow:"-5px 7px 25px 2px rgba(0,0,0,0.75)"},children:s()}),l("div",{style:{backgroundColor:"blue",border:"1px solid black",width:"97%",height:"3.5em",transform:"skew(29deg, 0deg"},children:M(C,{variant:"h3",textAlign:"center",children:[l("span",{style:{WebkitTextStroke:"50px solid black",color:"red"},children:"Connect"})," ",l("span",{style:{color:"yellow"},children:"Four"})]})})]})},se=({socket:r,game:n,finishGame:s,columns:c,rows:i,contiguousCountersToWin:a})=>{const{gameboard:f,makeMove:h,winningPlayer:w,draw:b,GameInformationText:F}=ie(r,n,c,i,a),g=n.players.filter(G=>G.id===(r==null?void 0:r.id))[0],y=n.players.filter(G=>G.id!==r.id)[0];return M("div",{style:{display:"flex",flexDirection:"column"},children:[M(C,{textAlign:"center",variant:"h5",children:[g==null?void 0:g.username,"(",g==null?void 0:g.counter,") vs ",y==null?void 0:y.username,"(",y==null?void 0:y.counter,")"]}),l(ae,{gameboard:f,makeMove:h}),M(X,{maxWidth:"sm",sx:{display:"flex",flexDirection:"column"},children:[l(F,{}),(w||b)&&l(v,{variant:"contained",onClick:s,children:"Return to Lobby"})]})]})},ce=({username:r,cancelFindingGame:n})=>M(R,{sx:{display:"flex",flexDirection:"column"},children:[l(C,{variant:"h2",children:r}),M(R,{sx:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",width:"17.5em"},children:[l(C,{variant:"h5",children:"Searching for a game"}),l(Y,{})]}),l(v,{variant:"contained",onClick:n,children:"Cancel"})]}),le=({username:r,setUsername:n})=>{const s=c=>n(c.target.value);return l(Z,{value:r!=null?r:"",onChange:s,placeholder:"Enter username..."})},de=({username:r,setUsername:n,onStartClick:s})=>M(k,{sx:{display:"flex",flexDirection:"column",maxWidth:"fit-content"},children:[l(C,{textAlign:"left",variant:"h2",children:"Connect Four \u{1F534}\u{1F7E1}"}),l(le,{username:r,setUsername:n}),l(v,{variant:"contained",onClick:s,children:"Find Game"})]}),ue=(r,n)=>_(r,{query:{username:n}}),fe=()=>"https://agile-crag-97738.herokuapp.com",me=r=>{const[n,s]=p.exports.useState(),[c,i]=p.exports.useState("PreLobby"),[a,f]=p.exports.useState();return p.exports.useEffect(()=>{if(!!n)return n.on("found game",b=>{i("Found game"),f(b)}),()=>{n==null||n.disconnect()}},[n]),{beginFindingGame:()=>{if(!r)return;const b=fe();i("Finding game"),s(ue(b,r))},endGame:()=>{i("PreLobby"),n==null||n.disconnect()},gameState:c,foundGame:a,socket:n}},xe=()=>{const[r,n]=p.exports.useState(),{beginFindingGame:s,endGame:c,foundGame:i,gameState:a,socket:f}=me(r);return M("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh"},children:[a==="PreLobby"&&l(de,{username:r,setUsername:n,onStartClick:s}),a==="Finding game"&&r&&l(ce,{username:r,cancelFindingGame:c}),a==="Found game"&&i&&f&&l(se,{socket:f,game:i,finishGame:c,columns:7,rows:6,contiguousCountersToWin:4})]})};ee.render(l(te.StrictMode,{children:l(xe,{})}),document.getElementById("root"));
